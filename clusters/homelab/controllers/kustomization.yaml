apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  # HelmRepositories (must be first)
  - jetstack.yaml
  - external-secrets.yaml  
  - emberstack.yaml
  - rook-release.yaml
  - hashicorp.yaml
  - fredericrous.yaml
  - node-feature-discovery-repository.yaml

  # Essential operators
  - reflector.yaml
  - rook-ceph.yaml
  - external-secrets-operator.yaml
  - cert-manager.yaml
  - vault-transit-unseal-operator.yaml
  # Temporarily disabled due to PodSecurity issues
  # - node-feature-discovery-namespace.yaml
  # - node-feature-discovery.yaml

  # Istio namespaces (must be before Istio components)
  - istio-namespaces.yaml
  
  # Istio core (required for mesh)
  - istio-repository.yaml
  - istio-base.yaml
  - istio-cni.yaml
  - istio-istiod.yaml
  - istio-ztunnel.yaml
  - istio-sa-fix.yaml