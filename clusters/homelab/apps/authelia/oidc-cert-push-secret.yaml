---
# Push OIDC private key to Vault
apiVersion: external-secrets.io/v1
kind: PushSecret
metadata:
  name: push-authelia-oidc-private-key
  namespace: authelia
spec:
  refreshInterval: 30s
  secretStoreRef:
    kind: SecretStore
    name: vault-backend
  selector:
    secret:
      name: authelia-oidc-cert-temp
  data:
  - match:
      secretKey: private_key
      remoteRef:
        remoteKey: secret/data/authelia
        property: OIDC_ISSUER_PRIVATE_KEY

---
# Push OIDC certificate to Vault
apiVersion: external-secrets.io/v1
kind: PushSecret
metadata:
  name: push-authelia-oidc-certificate
  namespace: authelia
spec:
  refreshInterval: 30s
  secretStoreRef:
    kind: SecretStore
    name: vault-backend
  selector:
    secret:
      name: authelia-oidc-cert-temp
  data:
  - match:
      secretKey: certificate
      remoteRef:
        remoteKey: secret/data/authelia
        property: OIDC_ISSUER_CERTIFICATE_CHAIN