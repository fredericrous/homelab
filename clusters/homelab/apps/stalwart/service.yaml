apiVersion: v1
kind: Service
metadata:
  name: stalwart
  namespace: stalwart
  annotations:
    istio.io/ingress-mtls: "true"
  labels:
    app: stalwart
spec:
  type: ClusterIP
  ports:
  - name: smtp
    port: 25
    targetPort: 25
    protocol: TCP
  - name: submission
    port: 587
    targetPort: 587
    protocol: TCP
  - name: smtps
    port: 465
    targetPort: 465
    protocol: TCP
  - name: imap
    port: 143
    targetPort: 143
    protocol: TCP
  - name: imaps
    port: 993
    targetPort: 993
    protocol: TCP
  - name: http
    port: 8080
    targetPort: 8080
    protocol: TCP
  - name: sieve
    port: 4190
    targetPort: 4190
    protocol: TCP
  selector:
    app: stalwart
---
apiVersion: v1
kind: Service
metadata:
  name: stalwart-mail-external
  namespace: stalwart
  labels:
    app: stalwart
spec:
  type: LoadBalancer
  ports:
  - name: smtp
    port: 25
    targetPort: 25
    protocol: TCP
  - name: submission
    port: 587
    targetPort: 587
    protocol: TCP
  - name: smtps
    port: 465
    targetPort: 465
    protocol: TCP
  - name: imap
    port: 143
    targetPort: 143
    protocol: TCP
  - name: imaps
    port: 993
    targetPort: 993
    protocol: TCP
  - name: sieve
    port: 4190
    targetPort: 4190
    protocol: TCP
  selector:
    app: stalwart