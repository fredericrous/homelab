apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: plex

# Use mTLS component to automatically sync client CA certificate
components:
  - ../../components/mtls-certificates

resources:
  - namespace.yaml
  - service-account.yaml
  - rbac.yaml
  - helm-repository.yaml
  - vault-config-job.yaml
  - external-secrets.yaml
  - pvc.yaml
  - pre-install-hook.yaml
  - helm-release.yaml
  - gateway.yaml
  - virtualservice.yaml
  - peerauthentication.yaml
  - certificate.yaml

# Configuration for mTLS component
configMapGenerator:
- name: mtls-config
  literals:
  - serviceAccount=plex