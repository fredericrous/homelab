---
apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: vault-nas
  namespace: flux-system
spec:
  values:
    # Ensure fsGroup is set for proper volume permissions
    server:
      securityContext:
        pod:
          fsGroup: 1000
        container:
          runAsNonRoot: true
          runAsUser: 100
          runAsGroup: 1000
      
      # Use host networking for cross-cluster access
      hostNetwork: true
      dnsPolicy: ClusterFirstWithHostNet
    
    # Keep ClusterIP for internal cluster access
    ui:
      serviceType: ClusterIP