apiVersion: v1
kind: ConfigMap
metadata:
  name: minio-values
  namespace: flux-system
data:
  values.yaml: |
    mode: standalone
    
    rootUser: admin
    rootPassword: changeme123
    
    persistence:
      enabled: true
      storageClass: nas-local
      size: 100Gi
    
    service:
      type: NodePort
      port: 9000
      nodePort: 61900
    
    consoleService:
      type: NodePort
      port: 9001
      nodePort: 61901
    
    resources:
      requests:
        memory: 1Gi
        cpu: 100m
      limits:
        memory: 2Gi
        cpu: 500m
    
    environment:
      MINIO_PROMETHEUS_AUTH_TYPE: "public"
    
    securityContext:
      runAsUser: 1000
      runAsGroup: 1000
      fsGroup: 1000
      runAsNonRoot: true
    
    extraInitContainers:
      - name: init-chown
        image: busybox:1.35
        command:
          - sh
          - -c
          - |
            chown -R 1000:1000 /export
            chmod -R 755 /export
        securityContext:
          runAsUser: 0
        volumeMounts:
          - name: export
            mountPath: /export